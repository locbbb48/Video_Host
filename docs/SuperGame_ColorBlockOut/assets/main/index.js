System.register("chunks:///_virtual/Block.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./Door.ts","./PosCheck.ts","./GridManager.ts","./Grid.ts","./BlockManager.ts","./SoundManager.ts"],(function(t){var e,o,n,i,r,l,a,s,c,u,d,f,p,h,w,g,m,v,b,y,C,k,O;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){l=t.cclegacy,a=t._decorator,s=t.Sprite,c=t.Enum,u=t.Node,d=t.Collider2D,f=t.Contact2DType,p=t.Vec3,h=t.tween,w=t.Component},function(t){g=t.cType,m=t.Colors},function(t){v=t.Door},function(t){b=t.PosCheck},function(t){y=t.GridManager},function(t){C=t.Grid},function(t){k=t.BlockManager},function(t){O=t.SoundManager}],execute:function(){var P,M,N,S,B,z,D,F,L,G,x,R,T,E,I,_,A,U,V,W,j,H,X,Y;l._RF.push({},"9a850AYxQJGD4/XGKmONvct","Block",void 0);var J=a.ccclass,K=a.property,Q=a.executeInEditMode;t("Block",(P=J("Block"),M=K(s),N=K(s),S=K({type:c(g)}),B=K(u),z=K(u),D=K(u),F=K(u),L=K(u),P(G=Q((R=e((x=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return e=t.call.apply(t,[this].concat(n))||this,i(e,"blockSprite",R,r(e)),i(e,"borderSprite",T,r(e)),i(e,"type",E,r(e)),e._lastType=g.RED,i(e,"door",I,r(e)),i(e,"left",_,r(e)),i(e,"right",A,r(e)),i(e,"up",U,r(e)),i(e,"down",V,r(e)),i(e,"offsetLeft",W,r(e)),i(e,"offsetRight",j,r(e)),i(e,"offsetUp",H,r(e)),i(e,"offsetDown",X,r(e)),i(e,"canMove",Y,r(e)),e.listNodeOwnFrame=[],e}o(e,t);var l=e.prototype;return l.onLoad=function(){this.borderSprite&&(this.borderSprite.node.active=!1),this.blockSprite||(this.blockSprite=this.getComponent(s)),this.updateColor(),this.initListNodeOwn(),this.canMove=!0;var t=this.getComponent(d);t&&t.on(f.PRE_SOLVE,this.onStayContact,this)},l.start=function(){this.setToClosestGrid()},l.update=function(){this._lastType!==this.type&&(this.updateColor(),this._lastType=this.type)},l.SetBorder=function(){this.borderSprite?this.borderSprite.node.active=!0:console.warn("Border sprite is null")},l.ClearBorder=function(){this.borderSprite?this.borderSprite.node.active=!1:console.warn("Border sprite is null")},l.updateColor=function(){this.blockSprite.color=m[this.type]},l.onStayContact=function(t,e,o){var n=e.node.getComponent(v);n&&!1!==this.node.active&&n.type===this.type&&this.canPassDoor(n)&&(this.door||(this.door=e.node))},l.canPassDoor=function(t){var e=t.getAdjacentGridPositions();if(!e.length)return!1;var o=this.getBlockSizeOnGrid(),i=t.dirType,r=t.length,l=1===i||3===i?o.length:o.width;if(l>r)return!1;for(var a,s=new Set(e.map((function(t){return t.row+"-"+t.col}))),c=this.listNodeOwnFrame.map((function(t){var e=t.getComponent(b);return e.rowOwn+"-"+e.colOwn})),u=0,d=n(c);!(a=d()).done;){var f=a.value;s.has(f)&&u++}return u>=l},l.getBlockSizeOnGrid=function(){if(!this.listNodeOwnFrame.length)return{width:0,length:0};var t=this.listNodeOwnFrame.map((function(t){return t.getComponent(b).rowOwn})),e=this.listNodeOwnFrame.map((function(t){return t.getComponent(b).colOwn})),o=Math.min.apply(Math,t),n=Math.max.apply(Math,t),i=Math.min.apply(Math,e);return{width:Math.max.apply(Math,e)-i+1,length:n-o+1}},l.initListNodeOwn=function(){this.listNodeOwnFrame=this.node.children.filter((function(t){return t.getComponent(b)}))},l.InitDataOfListNodeOwnFrame=function(){this.listNodeOwnFrame.forEach((function(t){return t.getComponent(b).InitDataPos()}))},l.setToClosestGrid=function(){if(this.listNodeOwnFrame.length){var t=this.listNodeOwnFrame[0],e=t.getComponent(b).nodeCloset;if(e){var o=new p(e.worldPosition.x-t.worldPosition.x,e.worldPosition.y-t.worldPosition.y,0);this.node.setWorldPosition(this.node.worldPosition.clone().add(o)),this.door&&this.moveOutIfMatched()}}},l.moveOutIfMatched=function(){var t=this;this.door&&this.door.getComponent(v).type===this.type&&this.scheduleOnce((function(){var e,o,n=t.door.getComponent(v);O.instance.playSFX("door");var i=n.effect;i&&(i.active=!0);var r=150,l=new p(r,0,0);switch(n.dirType){case 1:l=new p(r,0,0);break;case 2:l=new p(0,-150,0);break;case 3:l=new p(-150,0,0);break;case 4:l=new p(0,r,0)}var a=t.node.worldPosition.clone().add(l);t.canMove=!0,t.listNodeOwnFrame.forEach((function(t){var e;null==(e=t.getComponent(b))||e.ReBackValue()})),null==(e=k.instance)||null==e.RemoveBlockInList||e.RemoveBlockInList(t.node),null!=(o=k.instance)&&null!=o.CheckNoMoreBlock&&o.CheckNoMoreBlock()&&console.log("No more block","You Win!!!"),h(t.node).to(1,{worldPosition:a}).call((function(){i&&(i.active=!1),t.node.active=!1})).start()}),.1)},l.getMoveLimit=function(){var t=this,e=y.instance.gridNodes,o=e.length,i=e[0].length,r=this.listNodeOwnFrame.map((function(t){var e=t.getComponent(b);return{row:e.rowOwn,col:e.colOwn}})),l={left:0,right:0,up:0,down:0},a=function(l){for(var a=0;;){a++;for(var s,c,u=r.map((function(t){return{row:"up"===l?t.row+a:"down"===l?t.row-a:t.row,col:"left"===l?t.col-a:"right"===l?t.col+a:t.col}})),d=function(){var n=c.value,l=n.row,s=n.col;if(l<0||l>=o||s<0||s>=i)return{v:a-1};var u,d=e[l][s];if(!r.some((function(t){return t.row===l&&t.col===s}))&&(null!=(u=d.getComponent(C))&&u.CheckOccupied(t.node)))return{v:a-1}},f=n(u);!(c=f()).done;)if(s=d())return s.v}};return l.left=a("left"),l.right=a("right"),l.up=a("up"),l.down=a("down"),l},l.getWorldLimitPosition=function(t){var e,o,n,i,r=y.instance.gridNodes;if(!r||r.length<2||r[0].length<2)return console.warn("❗ Grid dữ liệu không hợp lệ"),{min:this.node.worldPosition.clone(),max:this.node.worldPosition.clone()};var l=p.distance(r[0][0].worldPosition,r[0][1].worldPosition)/2,a=p.distance(r[0][0].worldPosition,r[1][0].worldPosition)/2,s=null==(e=this.left)||null==(e=e.getComponent(b))?void 0:e.nodeCloset,c=null==(o=this.right)||null==(o=o.getComponent(b))?void 0:o.nodeCloset,u=null==(n=this.up)||null==(n=n.getComponent(b))?void 0:n.nodeCloset,d=null==(i=this.down)||null==(i=i.getComponent(b))?void 0:i.nodeCloset;s&&c&&u&&d||console.warn("⚠️ Một trong các hướng không có nodeCloset:",{leftNode:s,rightNode:c,upNode:u,downNode:d});var f=s.worldPosition.x-(2*t.left+1)*l+this.offsetLeft,h=c.worldPosition.x+(2*t.right+1)*l-this.offsetRight,w=u.worldPosition.y+(2*t.up+1)*a-this.offsetUp,g=d.worldPosition.y-(2*t.down+1)*a+this.offsetDown;return{min:new p(f,g,0),max:new p(h,w,0)}},e}(w)).prototype,"blockSprite",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(x.prototype,"borderSprite",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(x.prototype,"type",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g.RED}}),I=e(x.prototype,"door",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(x.prototype,"left",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(x.prototype,"right",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(x.prototype,"up",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(x.prototype,"down",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(x.prototype,"offsetLeft",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),j=e(x.prototype,"offsetRight",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),H=e(x.prototype,"offsetUp",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),X=e(x.prototype,"offsetDown",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Y=e(x.prototype,"canMove",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),G=x))||G)||G));l._RF.pop()}}}));

System.register("chunks:///_virtual/BlockManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DeviceDirector.ts"],(function(t){var e,o,n,i,r,c,l,s,a,u,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,i=t.createClass,r=t.initializerDefineProperty,c=t.assertThisInitialized},function(t){l=t.cclegacy,s=t._decorator,a=t.Node,u=t.Component},function(t){h=t.DeviceDirector}],execute:function(){var k,f,p,B,d,v,b;l._RF.push({},"43a99kpaDVAqIhBnMbJLaBj","BlockManager",void 0);var g=s.ccclass,y=s.property;t("BlockManager",(k=g("BlockManager"),f=y([a]),k(((b=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n))||this,r(e,"listBlock",d,c(e)),e.totalBlocks=0,r(e,"blockUsedCount",v,c(e)),e}o(e,t);var l=e.prototype;return l.onLoad=function(){e._instance=this,this.Init()},l.Init=function(){var t=this;this.node.children.forEach((function(e){t.listBlock.push(e),t.totalBlocks++}))},l.RemoveBlockInList=function(t){var e=this.listBlock.indexOf(t);e>-1&&this.listBlock.splice(e,1),this.blockUsedCount>=0&&this.blockUsedCount--,this.blockUsedCount<=0&&h.instance.redirectToStore()},l.CheckNoMoreBlock=function(){return 0==this.listBlock.length},l.getAllBlocks=function(){for(var t,e=n(this.listBlock);!(t=e()).done;){t.value;return this.listBlock}},i(e,null,[{key:"instance",get:function(){return this._instance}}]),e}(u))._instance=void 0,d=e((B=b).prototype,"listBlock",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=e(B.prototype,"blockUsedCount",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),p=B))||p));l._RF.pop()}}}));

System.register("chunks:///_virtual/DeviceDirector.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var e,t;return{setters:[function(o){e=o.createClass},function(o){t=o.cclegacy}],execute:function(){t._RF.push({},"580fd2XbwVMzLtuFrHP7zCs","DeviceDirector",void 0),o("DeviceDirector",function(){function o(){}return o.prototype.redirectToStore=function(){var o=navigator.userAgent||navigator.vendor;/iPad|iPhone|iPod/.test(o)&&!("MSStream"in window)?(confirm("Dowload Game to play?"),window.location.href="https://apps.apple.com/sg/app/color-block-out/id6743066302"):(window.location.href="https://play.google.com/store/apps/details?id=com.slide.block.color.jam.out&hl=en",confirm("Dowload Game to play?"))},e(o,null,[{key:"instance",get:function(){return this._instance||(this._instance=new o),this._instance}}]),o}())._instance=void 0,t._RF.pop()}}}));

System.register("chunks:///_virtual/Door.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts"],(function(t){var o,e,i,n,r,l,a,c,u,s,p,f,d,h,b;return{setters:[function(t){o=t.applyDecoratedDescriptor,e=t.initializerDefineProperty,i=t.inheritsLoose,n=t.assertThisInitialized},function(t){r=t.cclegacy,l=t._decorator,a=t.Sprite,c=t.Enum,u=t.Node,s=t.BoxCollider,p=t.tween,f=t.Vec3,d=t.Component},function(t){h=t.cType,b=t.Colors}],execute:function(){var y,w,g,m,D,C,G,z,v,I,P,k,S,T,E,_,x;r._RF.push({},"08d67tsGGJCd4TPGDNvFMwk","Door",void 0);var R=l.ccclass,j=l.property,A=l.executeInEditMode,F=(l.type,t("DoorGridInfo",R("DoorGridInfo")((g=o((w=function(){e(this,"row",g,this),e(this,"col",m,this)}).prototype,"row",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=o(w.prototype,"col",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=w))||y));t("Door",(D=R("Door"),C=j({type:a}),G=j({type:c(h),tooltip:"Choose door color"}),z=j(u),v=j({type:[F],tooltip:"Nhập thủ công row/col các grid mà door sử dụng"}),D(I=A((k=o((P=function(t){function o(){for(var o,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return o=t.call.apply(t,[this].concat(r))||this,e(o,"blockSprite",k,n(o)),e(o,"type",S,n(o)),o._lastType=h.RED,e(o,"dirType",T,n(o)),e(o,"length",E,n(o)),e(o,"effect",_,n(o)),e(o,"manualGridInfos",x,n(o)),o}i(o,t);var r=o.prototype;return r.onLoad=function(){this.blockSprite||(this.blockSprite=this.getComponent(a)),this.updateColor(),this.effect&&(this.effect.active=!1)},r.start=function(){this.node.getComponent(s);this.getAdjacentGridPositions()},r.update=function(){this._lastType!==this.type&&(this.updateColor(),this._lastType=this.type)},r.updateColor=function(){this.blockSprite&&(this.blockSprite.color=b[this.type])},r.getAdjacentGridPositions=function(){return this.manualGridInfos&&this.manualGridInfos.length>0?this.manualGridInfos.map((function(t){return{row:t.row,col:t.col}})):[]},r.onCollisionEnter=function(t){},r.onCollisionExit=function(t){},r.DoorDown=function(){p(this.node).to(.3,{worldPosition:new f(this.node.worldPosition.add(new f(0,-3,0)))}).start()},r.DoorUp=function(){p(this.node).to(.3,{worldPosition:new f(this.node.worldPosition.add(new f(0,3,0)))}).start()},o}(d)).prototype,"blockSprite",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=o(P.prototype,"type",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h.RED}}),T=o(P.prototype,"dirType",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),E=o(P.prototype,"length",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),_=o(P.prototype,"effect",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(P.prototype,"manualGridInfos",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=P))||I)||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/Enum.ts",["cc"],(function(E){var e,n;return{setters:[function(E){e=E.cclegacy,n=E.Color}],execute:function(){var R;e._RF.push({},"ee6b2MoZp1Pi77GewqB9CXy","Enum",void 0);var t=E("cType",function(E){return E[E.RED=0]="RED",E[E.GREEN=1]="GREEN",E[E.GREEN2=8]="GREEN2",E[E.BLUE=2]="BLUE",E[E.YELLOW=3]="YELLOW",E[E.PURPLE=4]="PURPLE",E[E.ORANGE=5]="ORANGE",E[E.ORANGE2=9]="ORANGE2",E[E.CYAN=6]="CYAN",E[E.PINK=7]="PINK",E}({}));E("Colors",((R={})[t.RED]=new n(240,83,83,255),R[t.GREEN]=new n(145,236,36,255),R[t.GREEN2]=new n(145,236,36,254),R[t.BLUE]=new n(0,102,255,255),R[t.YELLOW]=new n(255,229,0,255),R[t.PURPLE]=new n(191,0,255,255),R[t.ORANGE]=new n(255,138,0,255),R[t.ORANGE2]=new n(255,138,0,254),R[t.CYAN]=new n(95,235,235,255),R[t.PINK]=new n(238,60,178,255),R)),E("TypeDirection",function(E){return E[E.Up=1]="Up",E[E.Down=2]="Down",E[E.Left=3]="Left",E[E.Right=4]="Right",E}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DeviceDirector.ts"],(function(n){var a,e,t,i,o,r,s,c,d,v,u,l,p;return{setters:[function(n){a=n.applyDecoratedDescriptor,e=n.inheritsLoose,t=n.createClass,i=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){r=n.cclegacy,s=n._decorator,c=n.Canvas,d=n.PhysicsSystem2D,v=n.UIOpacity,u=n.tween,l=n.Component},function(n){p=n.DeviceDirector}],execute:function(){var C,h,f,y,g,m,M,b,w,H;r._RF.push({},"f99aaY0UCBNqqEimxPXpL3/","GameManager",void 0);var D=s.ccclass,_=s.property;n("GameManager",(C=D("GameManager"),h=_(c),f=_(c),y=_(c),C(((H=function(n){function a(){for(var a,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return a=n.call.apply(n,[this].concat(t))||this,i(a,"VideoCanvas",M,o(a)),i(a,"MainCanvas",b,o(a)),i(a,"HandCanvas",w,o(a)),a.checkFirst=!1,a.checkCanTouch=!0,a}e(a,n);var r=a.prototype;return r.onLoad=function(){d.instance.enable=!0,this.HandCanvas.node.active=!1,this.MainCanvas.node.active=!1,this.VideoCanvas.node.active=!0,a._instance=this,window.onerror=function(){return p.instance.redirectToStore(),!1},window.addEventListener("unhandledrejection",(function(){p.instance.redirectToStore()}))},r.showMainCanvas=function(){var n=this;setTimeout((function(){n.VideoCanvas.node.active=!1,n.MainCanvas.node.active=!0,n.HandCanvas.node.active=!0}),100)},r.fadeToMainCanvas=function(){var n=this,a=this.VideoCanvas.node.getComponent(v),e=this.MainCanvas.node.getComponent(v),t=this.HandCanvas.node.getComponent(v);this.MainCanvas.node.active=!0,this.HandCanvas.node.active=!0,e.opacity=0,t.opacity=0,u(a).to(.5,{opacity:0}).call((function(){n.VideoCanvas.node.active=!1})).start(),u(e).delay(0).to(1,{opacity:255}).start(),u(t).delay(.5).to(1,{opacity:255}).start()},r.hideHandCanvas=function(){this.HandCanvas&&(this.HandCanvas.node.active=!1)},t(a,null,[{key:"instance",get:function(){return this._instance}}]),a}(l))._instance=void 0,M=a((m=H).prototype,"VideoCanvas",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=a(m.prototype,"MainCanvas",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=a(m.prototype,"HandCanvas",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=m))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/Grid.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,i,t,r,o,c,l,u;return{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,l=e.Node,u=e.Component}],execute:function(){var a,s,p,d,f,h,w,b;o._RF.push({},"28533H1juZCbYAdxWXAwgnv","Grid",void 0);var y=c.ccclass,O=c.property;e("Grid",(a=y("Grid"),s=O(l),p=O(l),a((h=n((f=function(e){function n(){for(var n,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return n=e.call.apply(e,[this].concat(o))||this,t(n,"special",h,r(n)),t(n,"nodeOwn",w,r(n)),t(n,"specialNode",b,r(n)),n.isOccupied=!1,n}i(n,e);var o=n.prototype;return o.start=function(){var e=this;this.special&&this.scheduleOnce((function(){e.nodeOwn=e.specialNode}),.2)},o.CheckOccupied=function(e){return null!==this.nodeOwn&&this.nodeOwn!==e},o.SetNodeOwn=function(e){this.nodeOwn=e},o.ReBackValue=function(){return this.nodeOwn=null},n}(u)).prototype,"special",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=n(f.prototype,"nodeOwn",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(f.prototype,"specialNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));o._RF.pop()}}}));

System.register("chunks:///_virtual/GridGenerate.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,r,t,n,o,l,a,c,u,d,s;return{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inheritsLoose,t=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,l=e._decorator,a=e.Prefab,c=e.instantiate,u=e.Vec3,d=e.Vec2,s=e.Component}],execute:function(){var g,p,f,b,h,z,y,S,w,C;o._RF.push({},"164b2IbbPlCaa9l0XdnwxR5","GridGenerate",void 0);var v=l.ccclass,G=l.property,m=l.executeInEditMode;e("GridGenerate",(g=v("GridGenerate"),p=G({type:a}),g(f=m((h=i((b=function(e){function i(){for(var i,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return i=e.call.apply(e,[this].concat(o))||this,t(i,"gridPrefab",h,n(i)),t(i,"gridSizeCol",z,n(i)),t(i,"gridSizeRow",y,n(i)),t(i,"cellSize",S,n(i)),t(i,"gridCenter",w,n(i)),t(i,"regenerate",C,n(i)),i}r(i,e);var o=i.prototype;return o.update=function(){},o.generateGrid=function(){this.node.removeAllChildren();for(var e=(this.gridSizeCol-1)*this.cellSize/2,i=(this.gridSizeRow-1)*this.cellSize/2,r=0;r<this.gridSizeRow;r++)for(var t=0;t<this.gridSizeCol;t++){var n=c(this.gridPrefab),o=t*this.cellSize-e+this.gridCenter.x,l=r*this.cellSize-i+this.gridCenter.y;n.setPosition(new u(o,l,0)),this.node.addChild(n)}console.log("✅ Grid generated in Editor.")},i}(s)).prototype,"gridPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(b.prototype,"gridSizeCol",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 9}}),y=i(b.prototype,"gridSizeRow",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 9}}),S=i(b.prototype,"cellSize",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 75}}),w=i(b.prototype,"gridCenter",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new d(0,0)}}),C=i(b.prototype,"regenerate",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=b))||f)||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/GridManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var e,r,t,n,l,o,a,s,d,h,c,u;return{setters:[function(i){e=i.applyDecoratedDescriptor,r=i.inheritsLoose,t=i.createClass,n=i.initializerDefineProperty,l=i.assertThisInitialized},function(i){o=i.cclegacy,a=i._decorator,s=i.Prefab,d=i.Node,h=i.Vec2,c=i.instantiate,u=i.Component}],execute:function(){var g,f,z,p,C,b,S,w,y,v,m,P,G,_,R,N,x,W,M;o._RF.push({},"8c06aSOnxRP6IIPg76MNEzS","GridManager",void 0);var D=a.ccclass,F=a.property,A=a.executeInEditMode;i("GridManager",(g=D("GridManager"),f=F({type:s}),z=F({type:s}),p=F(d),C=F({type:h}),b=F([d]),g(S=A(((M=function(i){function e(){for(var e,r=arguments.length,t=new Array(r),o=0;o<r;o++)t[o]=arguments[o];return e=i.call.apply(i,[this].concat(t))||this,n(e,"gridPrefab",y,l(e)),n(e,"wallPrefab",v,l(e)),n(e,"wallContainer",m,l(e)),n(e,"gridSizeCol",P,l(e)),n(e,"gridSizeRow",G,l(e)),n(e,"cellSize",_,l(e)),n(e,"gridCenter",R,l(e)),n(e,"regenerate",N,l(e)),n(e,"regenWall",x,l(e)),n(e,"listGrid",W,l(e)),e.gridNodes=[],e}r(e,i);var o=e.prototype;return o.onLoad=function(){e._instance=this,this.generateGrid2D()},o.update=function(){},o.generateGrid2D=function(){this.node.removeAllChildren(),this.gridNodes=[],this.listGrid=[];for(var i=(this.gridSizeCol-1)*this.cellSize/2,e=(this.gridSizeRow-1)*this.cellSize/2,r=0;r<this.gridSizeRow;r++){for(var t=[],n=0;n<this.gridSizeCol;n++){var l=c(this.gridPrefab),o=n*this.cellSize-i+this.gridCenter.x,a=r*this.cellSize-e+this.gridCenter.y;l.setPosition(o,a),l.name="Grid_"+r+"_"+n,this.node.addChild(l),this.listGrid.push(l),t.push(l)}this.gridNodes.push(t)}console.log("✅ Grid2D generated.")},o.recoverGridFromChildren=function(){this.gridNodes=[],this.listGrid=this.node.children;var i=this.gridSizeRow*this.gridSizeCol;if(this.listGrid.length===i)for(var e=(this.gridSizeCol-1)*this.cellSize/2,r=(this.gridSizeRow-1)*this.cellSize/2,t=0;t<this.gridSizeRow;t++){for(var n=[],l=0;l<this.gridSizeCol;l++){var o=t*this.gridSizeCol+l,a=this.listGrid[o],s=l*this.cellSize-e+this.gridCenter.x,d=t*this.cellSize-r+this.gridCenter.y;a.setPosition(s,d),n.push(a)}this.gridNodes.push(n)}else console.warn("⚠️ Grid count mismatch:",this.listGrid.length,"≠",i)},o.FindNodePosition=function(i){for(var e=0;e<this.gridNodes.length;e++)for(var r=0;r<this.gridNodes[e].length;r++)if(this.gridNodes[e][r]===i)return{row:e,col:r};return null},o.generateWallAroundGrid=function(){if(this.wallContainer){this.wallContainer.removeAllChildren();for(var i=this.cellSize*this.gridSizeCol,e=this.cellSize*this.gridSizeRow,r=this.gridCenter.x-i/2-16.25,t=this.gridCenter.x+i/2+16.25,n=this.gridCenter.y+e/2+16.25,l=this.gridCenter.y-e/2-16.25,o=0;o<this.gridSizeRow;o++){var a=o*this.cellSize-(this.gridSizeRow-1)*this.cellSize/2+this.gridCenter.y,s=c(this.wallPrefab);s.setPosition(r,a),s.name="Wall_Left_"+o,this.wallContainer.addChild(s);var d=c(this.wallPrefab);d.setPosition(t,a),d.name="Wall_Right_"+o,this.wallContainer.addChild(d)}for(var h=0;h<this.gridSizeCol;h++){var u=h*this.cellSize-(this.gridSizeCol-1)*this.cellSize/2+this.gridCenter.x,g=c(this.wallPrefab);g.setPosition(u,n),g.setRotationFromEuler(0,0,90),g.name="Wall_Top_"+h,this.wallContainer.addChild(g);var f=c(this.wallPrefab);f.setPosition(u,l),f.setRotationFromEuler(0,0,90),f.name="Wall_Bottom_"+h,this.wallContainer.addChild(f)}console.log("🧱 Walls created inside wallContainer.")}},t(e,null,[{key:"instance",get:function(){return this._instance}}]),e}(u))._instance=void 0,y=e((w=M).prototype,"gridPrefab",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(w.prototype,"wallPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(w.prototype,"wallContainer",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(w.prototype,"gridSizeCol",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 9}}),G=e(w.prototype,"gridSizeRow",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 9}}),_=e(w.prototype,"cellSize",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 65}}),R=e(w.prototype,"gridCenter",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new h(0,0)}}),N=e(w.prototype,"regenerate",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=e(w.prototype,"regenWall",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),W=e(w.prototype,"listGrid",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=w))||S)||S));o._RF.pop()}}}));

System.register("chunks:///_virtual/InputManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./BlockManager.ts","./Block.ts","./SoundManager.ts"],(function(t){var e,n,o,i,a,r,s,c,u,h,l,d,f,p,T,g,m,v,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.createForOfIteratorHelperLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,c=t.Camera,u=t.input,h=t.Input,l=t.Vec3,d=t.Vec2,f=t.PhysicsSystem2D,p=t.math,T=t.Component},function(t){g=t.GameManager},function(t){m=t.BlockManager},function(t){v=t.Block},function(t){y=t.SoundManager}],execute:function(){var C,D,E,M,H;r._RF.push({},"a82a3zHIdlMKJJUKRgHmLdr","InputManager",void 0);var k=s.ccclass,O=s.property;t("InputManager",(C=k("InputManager"),D=O(c),C((H=e((M=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,i(e,"mainCam",H,a(e)),e.nodeDetect=null,e.offset=new l,e.checkFirst=!1,e}n(e,t);var r=e.prototype;return r.onLoad=function(){u.on(h.EventType.TOUCH_START,this.onTouchStart,this),u.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),u.on(h.EventType.TOUCH_END,this.onTouchEnd,this),u.on(h.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},r.onDestroy=function(){u.off(h.EventType.TOUCH_START,this.onTouchStart,this),u.off(h.EventType.TOUCH_MOVE,this.onTouchMove,this),u.off(h.EventType.TOUCH_END,this.onTouchEnd,this),u.off(h.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},r.getWorldPosFromTouch=function(t){var e=t.getUILocation(),n=new l;return this.mainCam.screenToWorld(n.set(e.x,e.y,0)),n},r.onTouchStart=function(t){if(y.instance.playSFX("touch"),g.instance.checkCanTouch&&(this.checkFirst||(null==g.instance.hideHandCanvas||g.instance.hideHandCanvas(),this.checkFirst=!0),!(m.instance.blockUsedCount<=0))){m.instance.getAllBlocks();var e=this.getBlockByRaycast(t);if(e){var n;this.nodeDetect=e;var o=this.getWorldPosFromTouch(t),i=e.getWorldPosition();l.subtract(this.offset,i,o),null==(n=this.nodeDetect.getComponent(v))||n.SetBorder()}else this.nodeDetect=null}},r.getBlockByRaycast=function(t){t.getUILocation();for(var e,n=this.getWorldPosFromTouch(t),i=new d(n.x,n.y),a=f.instance.testPoint(i),r=o(a);!(e=r()).done;){return e.value.node}return null},r.onTouchEnd=function(t){if(this.nodeDetect){var e=this.nodeDetect.getComponent(v);e.setToClosestGrid(),e.ClearBorder(),e=null,this.nodeDetect=null}},r.onTouchMove=function(t){if(this.nodeDetect&&this.nodeDetect.isValid){var e=this.nodeDetect.getComponent(v);if(e){var n=this.getWorldPosFromTouch(t),o=new l;l.add(o,n,this.offset),e.InitDataOfListNodeOwnFrame();var i=e.getMoveLimit(),a=e.getWorldLimitPosition(i),r=p.clamp(o.x,a.min.x,a.max.x),s=p.clamp(o.y,a.min.y,a.max.y);this.nodeDetect.setWorldPosition(r,s,0)}}},e}(T)).prototype,"mainCam",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=M))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Block.ts","./Door.ts","./Grid.ts","./PosCheck.ts","./BlockManager.ts","./GameManager.ts","./GridManager.ts","./InputManager.ts","./Test.ts","./DeviceDirector.ts","./GridGenerate.ts","./SoundManager.ts","./StartVideo.ts","./Enum.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PosCheck.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridManager.ts","./Grid.ts"],(function(e){var n,t,o,i,r,a,c,s,l,u,d,p;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.createForOfIteratorHelperLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,c=e._decorator,s=e.Node,l=e.Vec3,u=e.Component},function(e){d=e.GridManager},function(e){p=e.Grid}],execute:function(){var h,f,w,g,m,C,O,b;a._RF.push({},"68cf2WRCm1PpJ10Km7gSPoC","PosCheck",void 0);var v=c.ccclass,P=c.property;e("PosCheck",(h=v("PosCheck"),f=P(s),h((m=n((g=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"rowOwn",m,r(n)),i(n,"colOwn",C,r(n)),i(n,"nodeCloset",O,r(n)),i(n,"minDistance",b,r(n)),n}t(n,e);var a=n.prototype;return a.start=function(){this.InitDataPos()},a.InitDataPos=function(){var e,n=this.FindNodeCloset();if(n){var t=d.instance.FindNodePosition(n);if(t){var o=null==(e=d.instance.gridNodes[this.rowOwn])?void 0:e[this.colOwn];o&&o.getComponent(p).nodeOwn===this.node.parent&&o.getComponent(p).ReBackValue(),this.rowOwn=t.row,this.colOwn=t.col,d.instance.gridNodes[t.row][t.col].getComponent(p).SetNodeOwn(this.node.parent)}}else console.warn("⚠️ Không tìm được nodeCloset cho "+this.node.name)},a.ReBackValue=function(){d.instance.gridNodes[this.rowOwn][this.colOwn].getComponent(p).ReBackValue()},a.FindNodeCloset=function(){for(var e,n=null,t=Number.MAX_VALUE,i=this.node.getWorldPosition(),r=o(d.instance.listGrid);!(e=r()).done;){var a=e.value,c=a.getWorldPosition(),s=l.distance(i,c),u=a.getComponent(p),h=u.nodeOwn===this.node.parent;s<this.minDistance&&(!u.CheckOccupied()||h)&&s<t&&(t=s,n=a)}return this.nodeCloset=n,n},n}(u)).prototype,"rowOwn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=n(g.prototype,"colOwn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),O=n(g.prototype,"nodeCloset",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(g.prototype,"minDistance",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 65}}),w=g))||w));a._RF.pop()}}}));

System.register("chunks:///_virtual/SoundManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,t,n,i,r,u,c,s,a,l,p,d;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,u=e._decorator,c=e.Sprite,s=e.Node,a=e.AudioSource,l=e.resources,p=e.AudioClip,d=e.Component}],execute:function(){var f,h,g,m,b,S,y,M,v,x,N,w;r._RF.push({},"3bc80zSEfFFapoRD+8CJ1BH","SoundManager",void 0);var z=u.ccclass,D=u.property;e("SoundManager",(f=z("SoundManager"),h=D(c),g=D(s),m=D(s),b=D(s),f(((w=function(e){function o(){for(var o,t=arguments.length,r=new Array(t),u=0;u<t;u++)r[u]=arguments[u];return o=e.call.apply(e,[this].concat(r))||this,n(o,"muteIcon",M,i(o)),o.isMuted=!1,o.bgmSource=null,o.sfxSource=null,n(o,"bgmNode",v,i(o)),n(o,"sfxTouchNode",x,i(o)),n(o,"sfxDoorNode",N,i(o)),o}t(o,e);var r=o.prototype;return r.onLoad=function(){o.instance=this,this.bgmSource=this.bgmNode.getComponent(a),this.sfxSource=this.sfxTouchNode.getComponent(a),this.sfxDoorNode.getComponent(a),this.muteIcon.node.active=this.isMuted},r.toggleMute=function(){this.isMuted=!this.isMuted,this.muteIcon.node.active=this.isMuted,this.bgmSource.volume=this.isMuted?0:1,this.sfxSource.volume=this.isMuted?0:1},r.playBGM=function(e){var o=this;l.load("Sound/"+e,p,(function(t,n){!t&&n?(o.bgmSource.clip=n,o.bgmSource.loop=!0,o.bgmSource.play()):console.warn("Không tìm thấy nhạc nền:",e)}))},r.playSFX=function(e){var o=this;l.load("audio/"+e,p,(function(t,n){!t&&n?o.sfxSource.playOneShot(n,1):console.warn("Không tìm thấy sound effect:",e)}))},r.stopBGM=function(){this.bgmSource.stop()},o}(d)).instance=void 0,M=o((y=w).prototype,"muteIcon",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=o(y.prototype,"bgmNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(y.prototype,"sfxTouchNode",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=o(y.prototype,"sfxDoorNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=y))||S));r._RF.pop()}}}));

System.register("chunks:///_virtual/StartVideo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(e){var t,n,o,r,i,a,c,l,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,c=e.VideoPlayer,l=e.Component},function(e){s=e.GameManager}],execute:function(){var u,d,p,v,y;i._RF.push({},"6a87dEq+dpIopGtoq4NeR7s","StartVideo",void 0);var f=a.ccclass,h=a.property;e("StartVideo",(u=f("StartVideo"),d=h(c),u((y=t((v=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,o(t,"videoPlayer",y,r(t)),t.hasStarted=!1,t}n(t,e);var i=t.prototype;return i.onLoad=function(){var e=this,t=document.querySelector("video");t&&(t.style.pointerEvents="none"),this.videoPlayer.mute=!0,setTimeout((function(){e.videoPlayer.node.active=!0,e.videoPlayer.play()}),100)},i.start=function(){this.videoPlayer.node.on(c.EventType.COMPLETED,(function(){setTimeout((function(){var e;null==(e=s.instance)||e.fadeToMainCanvas()}),50)}),this)},t}(l)).prototype,"videoPlayer",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=v))||p));i._RF.pop()}}}));

System.register("chunks:///_virtual/Test.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"57fcezaBbJExaNLXr55uksz","Test",void 0),e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});